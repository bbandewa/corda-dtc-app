<!DOCTYPE HTML>
<HTML xmlns="http://www.w3.org/1999/xhtml">
<HEAD>
    <META content="IE=11.0000"
          http-equiv="X-UA-Compatible">
    <TITLE>User Registration</TITLE>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8"><!-- jQuery -->

    <SCRIPT src="js/jquery-1.10.1.min.js"></SCRIPT>

    <SCRIPT src="js/jquery-migrate-1.2.1.min.js"></SCRIPT>

    <SCRIPT src="js/jquery-ui.js"></SCRIPT>

    <SCRIPT src="js/grid.locale-en.js"></SCRIPT>

    <SCRIPT src="js/jquery.jqGrid.min.js"></SCRIPT>

    <SCRIPT src="js/custom.js"></SCRIPT>
    <!-- jquery-ui CSS -->
    <LINK href="css/jquery-ui.css"
          rel="stylesheet">     <!-- Bootstrap core CSS -->
    <LINK href="css/bootstrap.min.css"
          rel="stylesheet">
    <LINK href="css/ui.jqgrid.css" rel="stylesheet">
    <!-- Custom styles for this template -->
    <LINK href="css/jqGrid.bootstrap.css" rel="stylesheet">
    <LINK href="css/Custom.css" rel="stylesheet">
</HEAD>
<BODY>
    <FORM id="form1" method="post">
        <div class="websiteHeader" id="divWebHeader">
            <div class="row">
                <div class="col-md-1"><img src="images/KBCIcon.png" height="35" style="border:solid 1px white;margin-top:7px;margin-left:10px; " /></div>
                <div class="col-md-3"><h3 style="margin-bottom:0px; margin-top:10px;margin-left:20px;">Digital Trade Chain</h3></div>
                <div class="col-md-8">
                    <div class="pull-right" style="text-align:right; margin-bottom:0px; margin-top:10px;margin-right:100px;font-size:15px;">
                        <div class="dropdown">
                            <a href="#" id="lnkUsersettings" data-toggle="dropdown" class="dropdown-toggle" style="color:white !important;">
                                <img src="images/userImage.png" height="35" class="img-circle" /> &nbsp;&nbsp;<span id="lblBankTitle"></span> &nbsp; <span class="glyphicon glyphicon-triangle-bottom"></span>
                            </a>
                            <div class="dropdown-menu" style="min-width:200px;background-color:#f5f5f5; padding:10px;">
                                <div class="row marginBottom10">
                                    <div class="col-md-12" style="margin-bottom:7px;">
                                        <a>  My Profile</a>
                                    </div>
                                </div>
                                <div class="row" style="margin-bottom:7px;">
                                    <div class="col-md-12">
                                        <a href="#">Change Password</a>
                                    </div>
                                </div>
                                <div class="row" style="margin-bottom:7px;">
                                    <div class="col-md-12">
                                        <a href="#">Logout</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="busyStatus" id="divBusyStatus" style="text-align: center">
            <div id="yourdiv" style="display: inline-block;">
                <div class="loader">
                </div>
            </div>
            <h2>Please wait...</h2>
        </div>
        <DIV class="container" style="width: 65%; margin-top:60px;">
            <DIV id="content">
                <DIV class="form-horizontal">
                    <div class="row">
                        <div class="col-md-6"><h4 style="color:#666769">Create an Account</h4></div>
                        <!--<div class="col-md-6"><span class="pull-right"><label id="lblBankTitle"></label></span></div>-->
                    </div>
                    <DIV class="panel">
                        <DIV class="panel panel-info" id="divOrderDetailsContainer">
                            <div class="well well-sm">Company Information</div>
                            <DIV class="panel-body" style="margin-bottom:15px;">
                                <DIV class="form-group">
                                    <LABEL class="control-label col-sm-2" for="txtCompanytName">Company Name:</LABEL>
                                    <div class="col-sm-9">
                                        <input class="form-control" id="txtCompanytName" placeholder="Company Name">
                                    </div>
                                </DIV>
                                <DIV class="form-group">
                                    <LABEL class="control-label col-sm-2" for="txtIBAN">IBAN:</LABEL>
                                    <div class="col-sm-3">
                                        <input class="form-control" type="text" placeholder="IBAN" id="txtIBAN" />
                                    </div>
                                    <LABEL class="control-label col-sm-3" for="txtRegisterVATNumber">Register/VAT Number:</LABEL>
                                    <div class="col-sm-3">
                                        <input class="form-control" type="text" placeholder="Register/VAT Number" id="txtRegisterVATNumber" />
                                    </div>
                                </DIV>
                                <!--<DIV class="form-group">
                                    <LABEL class="control-label col-sm-2" for="txtDateofBirth">Date of Birth:</LABEL>
                                    <div class="col-sm-3">
                                        <input class="form-control" placeholder="YYYY/MM/DD" id="txtDateofBirth" />
                                    </div>
                                    <label class="control-label col-sm-3" for="ddlGender">Gender:</label>
                                    <div class="col-sm-3">
                                        <SELECT class="form-control" id="ddlGender">
                                            <OPTION>-- Select --</OPTION>
                                            <OPTION>Male</OPTION>
                                            <OPTION>Female</OPTION>
                                        </SELECT>
                                    </div>
                                </DIV>-->
                            </DIV>
                            <div class="well well-sm">Company Contact Details</div>
                            <DIV class="panel-body" style="margin-bottom:15px;">
                                <DIV class="form-group">
                                    <LABEL class="control-label col-sm-2" for="txtContactName">Contact Name:</LABEL>
                                    <div class="col-sm-9">
                                        <input class="form-control" type="text" placeholder="Contact Name" id="txtContactName" />
                                    </div>
                                </DIV>
                                <DIV class="form-group">
                                    <LABEL class="control-label col-sm-2" for="txtAddress">Address:</LABEL>
                                    <div class="col-sm-9">
                                        <input class="form-control" type="text" placeholder="Address" id="txtAddress" />
                                    </div>
                                </DIV>
                                <!--<DIV class="form-group">
                                    <LABEL class="control-label col-sm-2" for="txtAddress2">Address 2:</LABEL>
                                    <div class="col-sm-9">
                                        <input class="form-control" placeholder="Address 2" type="text" id="txtAddress2" />
                                    </div>
                                </DIV>-->
                                <DIV class="form-group">
                                    <LABEL class="control-label col-sm-2" for="txtCity">City:</LABEL>
                                    <div class="col-sm-3">
                                        <input class="form-control" type="text" placeholder="City" id="txtCity" />
                                    </div>
                                    <LABEL class="control-label col-sm-3" for="txtPostalCode">Postal Code:</LABEL>
                                    <div class="col-sm-3">
                                        <input class="form-control" type="text" placeholder="Postal Code" id="txtPostalCode" />
                                    </div>
                                </DIV>
                                <DIV class="form-group">
                                    <LABEL class="control-label col-sm-2" for="txtState">State:</LABEL>
                                    <div class="col-sm-3">
                                        <input class="form-control" type="text" placeholder="State" id="txtState" />
                                    </div>
                                    <LABEL class="control-label col-sm-3" for="txtCountry">Country:</LABEL>
                                    <div class="col-sm-3">
                                        <input class="form-control" type="text" placeholder="Country" id="txtCountry" />
                                    </div>
                                </DIV>
                                <DIV class="form-group">
                                    <LABEL class="control-label col-sm-2" for="txtEmail">Email:</LABEL>
                                    <div class="col-sm-9">
                                        <input class="form-control" type="email" placeholder="Company Email Address" id="txtEmail" />
                                    </div>
                                </DIV>
                                <DIV class="form-group">
                                    <LABEL class="control-label col-sm-2" for="txtContactNumber">Contact Number:</LABEL>
                                    <div class="col-sm-9">
                                        <input class="form-control" type="text" placeholder="Company Contact Number" id="txtContactNumber" />
                                    </div>
                                </DIV>
                                <DIV class="form-group">
                                    <LABEL class="control-label col-sm-2" for="txtWebsite">Website:</LABEL>
                                    <div class="col-sm-9">
                                        <input class="form-control" type="text" placeholder="Company Website URL" id="txtWebsite" />
                                    </div>
                                </DIV>
                            </DIV>
                            <div class="well well-sm">User Credentials</div>
                            <DIV class="panel-body" style="margin-bottom:15px;">
                                <DIV class="form-group">
                                    <LABEL class="control-label col-sm-2" for="txtUsername">Username:</LABEL>
                                    <div class="col-sm-9">
                                        <input class="form-control" id="txtUsername" placeholder="Username">
                                    </div>
                                </DIV>
                                <DIV class="form-group">
                                    <label class="control-label col-sm-2" for="txtPassword">Password:</label>
                                    <div class="col-sm-3">
                                        <input class="form-control" type="password" id="txtPassword" placeholder="Password" />
                                    </div>
                                    <label class="control-label col-sm-3" for="txtConfirmPassword">Confirm Password:</label>
                                    <div class="col-sm-3">
                                        <input class="form-control" type="password" id="txtConfirmPassword" placeholder="Confirm Password" />
                                    </div>
                                </DIV>
                            </DIV>
                        </DIV>
                    </DIV>
                    <DIV class="panel">
                        <DIV class="form-group">
                            <LABEL class="control-label col-sm-2"></LABEL>
                            <div class="col-sm-9">
                                <BUTTON class="btn btn-info " id="btnSave">Save</BUTTON>
                                <BUTTON class="btn btn-info" id="btnClose">Cancel</BUTTON>
                            </div>
                        </DIV>
                    </DIV>
                </DIV>
            </DIV>
        </DIV>
        <SCRIPT type="text/javascript">
            //var userID = "abc123";
            var newAccount = new Object();
            $(document).ready(function () {
                $("#lnkUsersettings").popover({ trigger: "hover" });
                setBankTitle();
                // Setup grid
                $("#btnSave").click(function (e) {
                    newAccount = getAccountInfoFromInputs();
                    $.ajax({
                        type: "PUT",
                        async:false,
                        url: serviceURL + "user-registration",
                        dataType: "json",
                        contentType: "application/json;charset=UTF-8",
                        data: JSON.stringify(newAccount), //objOrder will be parameter name in service.
                        beforeSend: function () {
                            $("#divBusyStatus").show();
                        },
                        complete: function () {
                            $("#divBusyStatus").hide();
                        },
                        success: function (data) {
                            alert('Account is registered successfully.');
                            window.location = "OrderList.htm?userID=" + userID;
                        },
                        error: function (errMsg) {
                            debugger;
                            //alert(errMsg);
                            //redirectUser("OrderList.htm?userID=" + userID);
                            window.location = "OrderList.htm?userID=" + userID;
                        }
                    });
                });
                function getAccountInfoFromInputs() {
                    newAccount = {};
                    newAccount.companyName = $("#txtCompanytName").val();
                    newAccount.registrationNo = $("#txtRegisterVATNumber").val();
                    newAccount.iban = $("#txtIBAN").val();
                    //newAccount.dateofBirth = $("#txtDateofBirth").val();
                    //newAccount.gender = $("#txtGender").val();
                    newAccount.contactName = $("#txtContactName").val();
                    newAccount.address = $("#txtAddress").val();
                    //newAccount.address2 = $("#txtAddress2").val();
                    newAccount.city = $("#txtCity").val();
                    newAccount.postalCode = $("#txtPostalCode").val();
                    newAccount.state = $("#txtState").val();
                    newAccount.country = $("#txtCountry").val();
                    newAccount.email = $("#txtEmail").val();
                    newAccount.contactNumber = $("#txtContactNumber").val();
                    newAccount.website = $("#txtWebsite").val();
                    newAccount.userId = $("#txtUsername").val();
                    newAccount.password = $("#txtPassword").val();
                    return newAccount;
                }
                function setBankTitle() {
                    $("#lblBankTitle").text("Welcome Guest !");
                    //var serviceURL = window.location.protocol + "//" + window.location.host + "/api/dtc/me";
                    $.ajax({
                        type: "GET",
                        url: serviceURL + "me",
                        dataType: "json",
                        contentType: "application/json;charset=UTF-8",
                        data: newAccount, //objOrder will be parameter name in service.
                        beforeSend: function () {
                            $("#divBusyStatus").show();
                        },
                        complete: function () {
                            $("#divBusyStatus").hide();
                        },
                        success: function (data) {
                            var currentSite = data.me;
                            var currentUsername = "Guest";
                            if (null != currentUser && undefined != currentUser && null != currentUser.userName && undefined != currentUser.userName) {
                                currentUsername = currentUser.userName;
                            }
                            $("#lblBankTitle").text("Welcome to " + currentSite + " " + currentUsername + " !");
                        },
                        error: function (errMsg) {
                            alert(errMsg);
                            //redirectUser("OrderList.htm?userID=" + userID);
                            //window.location = "OrderList.htm?userID=" + userID;
                        }
                    });
                }
                $("#divBusyStatus").hide();
                //$("#txtDateofBirth").datepicker({
                //    dateFormat: 'yy-mm-dd',
                //    minDate: new Date()
                //});
            });
        </SCRIPT>
    </FORM>
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <SCRIPT src="js/bootstrap.min.js"></SCRIPT>
    <!-- Visual Studio Browser Link -->
    <!-- End Browser Link -->
</BODY>
</HTML>